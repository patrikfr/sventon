<%
/*
 * ====================================================================
 * Copyright (c) 2005-2006 Sventon Project. All rights reserved.
 *
 * This software is licensed as described in the file LICENSE, which
 * you should have received as part of this distribution. The terms
 * are also available at http://sventon.berlios.de.
 * If newer versions of this license are posted there, you may use a
 * newer version instead, at your option.
 * ====================================================================
 */
%>
<%@ page import="de.berlios.sventon.util.ByteFormatter"%>

<table class="sventonEntriesTable">
  <c:set var="rowCount" value="0"/>
  <tr>
    <th></th>
    <th>Name</th>
    <th>Original size</th>
    <th>Compressed size</th>
    <th>Date</th>
    <th>CRC</th>
  </tr>
  <%
    long totalOrigSize = 0;
    long totalCompSize = 0;
    %>
  <c:forEach items="${entries}" var="zipEntry">
    <jsp:useBean id="zipEntry" type="java.util.zip.ZipEntry" />
    <jsp:useBean id="entryDate" class="java.util.Date" />

    <tr class="${rowCount mod 2 == 0 ? 'sventonEntryEven' : 'sventonEntryOdd'}">
      <%
        entryDate = new java.util.Date(zipEntry.getTime());
        totalOrigSize += zipEntry.getSize();
        totalCompSize += zipEntry.getCompressedSize();
      %>
      <c:choose>
        <c:when test="${zipEntry.directory}">
          <td><img src="images/icon_folder.png" alt="dir"/></td>
        </c:when>
        <c:otherwise>
          <td><img src="images/icon_file.png" alt="file"/></td>
        </c:otherwise>
      </c:choose>
      <td>${zipEntry.name}</td>
      <td class="sventonColRightAlign">${zipEntry.size}</td>
      <td class="sventonColRightAlign">${zipEntry.compressedSize}</td>
      <td class="sventonColNoWrap"><fmt:formatDate type="both" value="${entryDate}" dateStyle="short" timeStyle="short"/></td>
      <td>${zipEntry.crc}</td>
    </tr>
    <c:set var="rowCount" value="${rowCount + 1}"/>
  </c:forEach>

  <tr class="${rowCount mod 2 == 0 ? 'sventonEntryEven' : 'sventonEntryOdd'}">
    <td align="right"><b>Total:</b></td>
    <td><b>${rowCount} entries</b></td>
    <td align="right" title="<%=totalOrigSize%>&nbsp;bytes"><b><%if (totalOrigSize != 0) out.print(ByteFormatter.format(totalOrigSize, request.getLocale()));%></b></td>
    <td align="right" title="<%=totalCompSize%>&nbsp;bytes"><b><%if (totalCompSize != 0) out.print(ByteFormatter.format(totalCompSize, request.getLocale()));%></b></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
</table>
